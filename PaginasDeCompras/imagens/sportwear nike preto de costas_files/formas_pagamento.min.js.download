var formas_pagamento={selecionar:function(a,e){if(0==e&&(e=jQuery(".forma_pagamento_radio[id^=radio_"+a+"_]:checked").val(),void 0==e)){var r=jQuery(".forma_pagamento_radio[id^=radio_"+a+"_]");e=r[0]?r[0].value:1}jQuery(".forma_pagamento").removeAttr("checked"),jQuery("#forma_pagamento_"+a).attr("checked","checked"),jQuery("#codigo_integracao_"+a).attr("checked","checked"),jQuery("#forma_facilitador_id_"+a).attr("checked","checked"),jQuery(".forma_pagamento_radio").removeAttr("checked"),jQuery("#radio_"+a+"_"+e).attr("checked","checked"),jQuery(".finalizarBT").hide(),jQuery("#btn_"+a).show()},validar:function(a){return retorno=this.contrato(),retorno&&(7==a.acao&&this.popup(a),1==a.cartao?this.abre_cartao(a):(this.enableLoadButton(a),this.submeter())),retorno},enableLoadButton:function(a){jQuery("#"+a.id_botao).remove(),jQuery("#"+a.id_loading).show()},popup:function(a){window.open("",a.janela,"toolbar=0,location=0,directories=0,status=1,menubar=0,scrollbars=1,resizable=1,screenX=0,screenY=0,left=0,top=0,width=750,height=600")},abre_cartao:function(a){var e="/mvc/loja/forma_pagamento/dados_cartao/loja:"+a.loja+"/forma_pagamento_integrador_id:"+a.forma_pagamento_integrador_id,r=new lightwindow;r.activateWindow({href:e,title:"Dados do Cartï¿½o",width:650,height:433,type:"page"})},campo_erro:function(a){jQuery("#dados_cartao_campos #"+a).addClass("inputErro"),jQuery("#"+a+"_erro").show()},validaCartao:function(a){return erro=0,jQuery("#dados_cartao_campos input[type=text]").each(function(a,e){switch(e.id){case"validade_cartao_mes":if(e.value<1||e.value>12||e.value.length!=jQuery(e).attr("maxlength"))return formas_pagamento.campo_erro(e.id),erro=1,!1;break;case"numero_cartao":var r=jQuery("#cartao_is_between").val(),o=e.value.length;if("1"==r){if(o<jQuery(e).attr("minlength")||o>jQuery(e).attr("maxlength"))return formas_pagamento.campo_erro(e.id),erro=1,!1}else if(o!=jQuery(e).attr("minlength")&&o!=jQuery(e).attr("maxlength"))return formas_pagamento.campo_erro(e.id),erro=1,!1;if(!formas_pagamento.luhn(e.value))return formas_pagamento.campo_erro(e.id),erro=1,!1;break;case"codigo_seguranca":case"validade_cartao_ano":if(e.value.length!=jQuery(e).attr("minlength")&&e.value.length!=jQuery(e).attr("maxlength"))return formas_pagamento.campo_erro(e.id),erro=1,!1;break;default:if(""==e.value)return formas_pagamento.campo_erro(e.id),erro=1,!1}}),0==this.validaDataCartao()?(formas_pagamento.campo_erro("data_cartao"),erro=1,!1):void(0==erro&&(jQuery("#dados_cartao").html(jQuery("#dados_cartao_campos input[type=text]").clone()),jQuery("#dados_cartao_campos input[type=text]").attr("readonly",!0),this.enableLoadButton(a),this.submeter()))},contrato:function(){return jQuery("#contrato").val()&&!jQuery("#contrato:checked").val()?(jQuery("#erro2").show(),jQuery("#contrato").focus(),!1):!0},display:function(a){a=jQuery("#"+a),"none"==a.css("display")?a.show():a.hide()},reseta_erros:function(){jQuery(".mensagensErro").hide(),jQuery("#dados_cartao_campos input").removeClass("inputErro")},submeter:function(){window.setTimeout(this.lancaSubmeter(),1e3)},lancaSubmeter:function(){jQuery("#form_pagamento").submit()},validaDataCartao:function(){var a=new Date,e=new Date;return e.setFullYear(jQuery("#validade_cartao_ano").val(),jQuery("#validade_cartao_mes").val()-1,a.getDate()),e.getTime()>=a.getTime()?!0:!1},luhn:function(a){a=a.replace(/[^\d]/g,"");for(var e=0,r=a.length,o=r%2,t=0;r>t;t++){var n=parseInt(a.charAt(t));t%2==o&&(n*=2),n>9&&(n-=9),e+=n}return e%10==0}};